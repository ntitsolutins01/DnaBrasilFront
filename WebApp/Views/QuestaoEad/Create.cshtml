@model QuestaoEadModel
@{
    ViewData["Title"] = "Inclusão de Questão";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div id="vQuestaoEad">
    <div class="row">
        <div class="col-md-12">
            @using (@Html.BeginForm("Create", "QuestaoEad", FormMethod.Post, new { id = "formQuestaoEad", @class = "form-horizontal" }))
            {
                <section class="panel">
                    <!-- Header -->
                    <header class="panel-heading">
                        <div class="panel-actions">
                            <a href="#" class="panel-action panel-action-toggle" data-panel-toggle></a>
                        </div>
                        <h2 class="panel-title">Cadastro de Questão</h2>
                    </header>

                    <!-- Body -->
                    <div class="panel-body">
                        <div class="form-group row">
                            <label class="col-sm-3 control-label text-sm-right pt-2">Tipo de Curso <span class="required">*</span></label>
                            <div class="col-sm-4">
                                <select class="form-control populate select2" name="ddlTipoCurso" id="ddlTipoCurso" style="width:100%"
                                        required title="Por favor selecione o tipo de curso"
                                        asp-for="TipoCursosId" asp-items="Model.ListTipoCursos">
                                    <option value="">Selecionar Tipo de Curso</option>
                                </select>
                            </div>
                            <label class="col-sm-1 control-label text-sm-right pt-2">Curso <span class="required">*</span></label>
                            <div class="col-sm-4">
                                <select class="form-control populate select2" name="ddlCurso" id="ddlCurso" style="width:100%"
                                        required title="Por favor selecione o curso"
                                        asp-for="CursoId" asp-items="Model.ListCursos">
                                    <option value="">Selecionar Curso</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group row">
                            <label class="col-sm-3 control-label text-sm-right pt-2">Módulo <span class="required">*</span></label>
                            <div class="col-sm-4">
                                <select class="form-control populate select2" name="ddlModuloEad" id="ddlModuloEad" style="width:100%"
                                        required title="Por favor selecione o modulo"
                                        asp-for="ModuloEadId" asp-items="Model.ListModulosEad">
                                    <option value="">Selecionar Módulo</option>
                                </select>
                            </div>
                            <label class="col-sm-1 control-label text-sm-right pt-2">Aula <span class="required">*</span></label>
                            <div class="col-sm-4">
                                <select class="form-control populate select2" name="ddlAula" id="ddlAula" style="width:100%"
                                        required title="Por favor selecione a aula"
                                        asp-for="AulaId" asp-items="Model.ListAulas">
                                    <option value="">Selecionar Aula</option>
                                </select>
                            </div>
                        </div>

                        <!-- Texto/Imagem Section -->
                        <div class="form-group row">
                            <label class="col-sm-3 control-label text-sm-right pt-2">
                                <a href="#" v-on:click="addTextoImagem()" id="addToTable" class="btn btn-block btn-primary pull-left"><i class="fa fa-plus"></i> &nbsp;&nbsp;Adicionar Texto/Imagem </a>
                            </label>
                            <div class="col-sm-9 wrapper" id="textimg-container">
                                <!-- Dynamic inputs will be added here -->
                            </div>
                        </div>


                        <!-- Questao Field -->
                        <div class="form-group">
                            <label class="col-sm-1 control-label text-sm-right pt-2">Pergunta <span class="required">*</span></label>
                            <div class="col-sm-9">
                                <textarea class="form-control" rows="3" maxlength="500" name="pergunta" id="pergunta" required></textarea>
                            </div>
                            <label class="col-sm-1 control-label text-sm-right pt-2">Questao <span class="required">*</span></label>
                            <div class="col-sm-1">
                                <input type="text" name="questao" id="questao" class="form-control" maxlength="150" title="Por favor informe a questao." required />
                            </div>
                        </div>

                        <!-- Respostas Section -->
                        <div class="form-group">
                            <label class="col-sm-1 control-label text-sm-right pt-2">Respostas <span class="required">*</span></label>
                            <div class="col-sm-11 btn-group">
                                <button type="button" class="mb-xs mt-xs mr-xs btn btn-default dropdown-toggle" data-toggle="dropdown" aria-expanded="false" id="responseTypeButton">
                                    Selecione o Tipo de Resposta <span class="caret"></span>
                                </button>
                                <ul class="dropdown-menu" role="menu" id="responseTypeDropdown">
                                    <li><a href="#" data-type="short">Resposta curta</a></li>
                                    <li><a href="#" data-type="paragraph">Parágrafo</a></li>
                                    <li><a href="#" data-type="multiple">Múltipla escolha</a></li>
                                    <li><a href="#" data-type="checkbox">Caixa de seleção</a></li>
                                </ul>
                            </div>

                            <!-- Botão para adicionar mais respostas -->
                            <div class="col-sm-11 col-sm-offset-1">
                                <button type="button" class="btn btn-primary" id="addAnswerButton" disabled>Adicionar Respostas</button>
                            </div>
                        </div>

                        <!-- Área onde as respostas serão adicionadas -->
                        <div class="form-group">
                            <div class="col-sm-11 col-sm-offset-1" id="answersContainer"></div>
                        </div>


                        <div class="form-group">
                            <label class="col-sm-1 control-label text-sm-right pt-2">Referência</label>
                            <div class="col-sm-11">
                                <textarea class="form-control" rows="3" maxlength="300" name="referencia" id="referencia"></textarea>
                            </div>
                        </div>

                    </div>



                    <!-- Footer -->
                    <footer class="panel-footer">
                        <div class="row">
                            <div class="col-md-9 col-md-offset-3">
                                <a href="@Url.Action("Index", "QuestaoEad")" class="btn btn-dark pull-right" style="margin-left: 5px; margin-right: 5px;">
                                    <i class="fa fa-reply"></i> &nbsp;&nbsp;Voltar
                                </a>
                                <button type="reset" class="btn btn-danger pull-right" style="margin-left: 5px;">
                                    <i class="fa fa-remove"></i> &nbsp;&nbsp;Cancelar
                                </button>
                                <button type="submit" class="btn btn-success pull-right" style="margin-left: 5px;">
                                    <i class="fa fa-save"></i> &nbsp;&nbsp;Salvar
                                </button>
                            </div>
                        </div>
                    </footer>
                </section>
            }
        </div>
    </div>
</div>
@section CssSpecificVendor {
    <link rel="stylesheet" href="~/assets/vendor/bootstrap-fileupload/bootstrap-fileupload.min.css" />
    <link rel="stylesheet" href="~/assets/vendor/select2/css/select2.css" />
    <link rel="stylesheet" href="~/assets/vendor/select2-bootstrap-theme/select2-bootstrap.min.css" />
}
@section Scripts {
    <script src="~/assets/vendor/bootstrap-fileupload/bootstrap-fileupload.min.js"></script>
    <script src="~/assets/vendor/ios7-switch/ios7-switch.js"></script>
    <script src="~/assets/vendor/jquery-validation/jquery.validate.js"></script>
    <script src="~/assets/vendor/select2/js/select2.js"></script>
    <script src="~/js/QuestaoEad.js"></script>
    <script>
        

        function addAnswerInput() {
            const container = document.getElementById("answers-container");

            // Create a new text input field
            const input = document.createElement("input");
            input.type = "text";
            input.name = "respostas[]";
            input.className = "form-control";
            input.placeholder = "Digite uma resposta";
            input.style.marginBottom = "10px";

            // Append the new input field to the answers container
            container.appendChild(input);
        }

        function addTextoImagem() {

        }


        function toggleInputType() {
            var uploadType = document.getElementById("uploadType").value;
            var textInput = document.getElementById("textInput");
            var fileInput = document.getElementById("fileInput");

            if (uploadType === "text") {
                textInput.style.display = "block";
                fileInput.style.display = "none";
            } else if (uploadType === "image") {
                textInput.style.display = "none";
                fileInput.style.display = "block";
            } else {
                textInput.style.display = "none";
                fileInput.style.display = "none";
            }
        }

        const responseTypeButton = document.getElementById('responseTypeButton');
        const responseTypeDropdown = document.getElementById('responseTypeDropdown');
        const addAnswerButton = document.getElementById('addAnswerButton');
        const answersContainer = document.getElementById('answersContainer');
        let selectedResponseType = null;

        // Evento para alterar o tipo de resposta
        responseTypeDropdown.addEventListener('click', function (e) {
            e.preventDefault();
            if (e.target.tagName === 'A') {
                selectedResponseType = e.target.getAttribute('data-type');
                responseTypeButton.textContent = e.target.textContent + ' ';
                responseTypeButton.appendChild(document.createElement('span')).classList.add('caret');
                addAnswerButton.disabled = false;
                answersContainer.innerHTML = ''; // Limpar respostas ao trocar tipo
            }
        });

        // Função para adicionar inputs de resposta
        addAnswerButton.addEventListener('click', function () {
            if (!selectedResponseType) return;

            const answerInput = document.createElement('div');
            answerInput.className = 'form-group';

            switch (selectedResponseType) {

                case 'short':
                    answerInput.innerHTML = `
                                                <label class="col-sm-1 control-label text-sm-right">Resposta:</label>
                                                    <div class="col-sm-11">
                                                        <input type="text" class="form-control mb-3" placeholder="Resposta curta">
                                                    </div>
                                            `;
                    break;

                case 'paragraph':
                    answerInput.innerHTML = `
                                                <div class="form-group">
                                                <label class="col-sm-1 control-label text-sm-right">Resposta:</label>
                                                    <div class="col-sm-11">
                                                        <textarea class="form-control mb-3" rows="3" placeholder="Resposta em parágrafo"></textarea>
                                                    </div>
                                                </div>
                                            `;
                    break;

                case 'multiple':
                    const letter = String.fromCharCode(65 + answersContainer.children.length); // A, B, C...
                    answerInput.innerHTML = `
                                                <label>${letter})</label>
                                                <input type="text" class="form-control" placeholder="Opção ${letter}">
                                            `;
                    break;

                case 'checkbox':
                    answerInput.innerHTML = `
                                                <div class="checkbox">
                                                    <label>
                                                        <input type="checkbox">
                                                        <input type="text" class="form-control d-inline w-auto" placeholder="Texto da caixa de seleção">
                                                    </label>
                                                </div>
                                            `;
                    break;

                default:
                    break;
            }

            answersContainer.appendChild(answerInput);
        });
    </script>
}
